---
title: "DeepEPÂ : la bibliothÃ¨que de communication ultime pour vos modÃ¨les MoE"
summary: "DÃ©couvrez comment DeepEP propulse lâ€™entraÃ®nement et lâ€™infÃ©rence des architectures Mixtureâ€‘ofâ€‘Experts grÃ¢ce Ã  des kernels allâ€‘toâ€‘all ultraâ€‘performants, une prise en charge FP8 et un chevauchement communicationâ€‘calcul sans occuper les SM."
image: "/images/og/deepep-cover.jpg"
publishedAt: "2025-07-24"
tag: "DeepEP"
---

> **TL;DRÂ :**
>
> - **Jusquâ€™Ã â€¯150â€¯GB/s** de bande passante intranÅ“ud et **~40â€‘60â€¯GB/s** interâ€‘nÅ“uds
> - Kernels **basse latence** spÃ©cialement pensÃ©s pour le dÃ©codage en production
> - Support **FP8** et **contrÃ´le du nombre de SM** pour des tÃ¢ches gourÂ­mandes en calcul
> - Licence **MIT**, prÃªt Ã  Ãªtre forkÃ© et adaptÃ© Ã  votre cluster

---

## Pourquoi DeepEPâ€¯?

Les modÃ¨les **Mixtureâ€‘ofâ€‘Experts (MoE)** ont dÃ©montrÃ© un rapport capacitÃ©/performance exceptionnel, mais leur _talon dâ€™Achille_ reste la **communication allâ€‘toâ€‘all** (dispatch/combine) entre GPU.  
DeepEP, dÃ©veloppÃ© par lâ€™Ã©quipe **DeepSeekâ€‘AI**, relÃ¨ve ce dÃ©fi grÃ¢ce Ã â€¯:

1. **Kernels haut dÃ©bit** optimisÃ©s NVLinkâ€¯â†”â€¯RDMA, idÃ©aux pour lâ€™entraÃ®nement et le _prefilling_ dâ€™infÃ©rence.
2. **Kernels basse latence** pure RDMA pour le dÃ©codage tokenâ€‘parâ€‘token.
3. Un **hook** de chevauchement commâ€‘calc **sans monopoliser de SM**.
4. Un design Ã©volutifâ€¯: SM80 (Ampere) et SM90 (Hopper)â€¯; FP8 dispatch / BF16 combine.

---

## Performances clÃ©s

| ScÃ©nario                   | # experts  | Bande passante / Latence |
| -------------------------- | ---------- | ------------------------ |
| **IntranÅ“ud (NVLink)**     | 8          | ~155â€¯GB/s                |
| **InternÅ“ud (RDMA)**       | 16â€‘64      | ~43â€‘58â€¯GB/s              |
| **DÃ©codage RDMA (8 exp.)** | 128â€¯tokens | **77â€¯Âµs**                |

> _Ã€ noterÂ :_ grÃ¢ce aux optimisations rÃ©seau (avrilâ€¯2025) en collaboration avec Tencent, les perfs ont gagnÃ© **jusquâ€™Ã â€¯30â€¯%** ğŸ”¥.

---

## Installation express

#1 Cloner le dÃ©pÃ´t

<CodeBlock
  compact
  marginBottom="16"
  codeInstances={[
    {
      code: "git clone https://github.com/deepseek-ai/DeepEP",
      language: "bash",
    },
  ]}
/>

#2 Compiler NVSHMEM (requis pour lâ€™interâ€‘nÅ“uds)

<CodeBlock
  compact
  marginBottom="16"
  codeInstances={[
    {
      code: "NVSHMEM_DIR=/chemin/vers/nvshmem python setup.py install",
      language: "bash",
    },
  ]}
/>
